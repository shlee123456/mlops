{% extends "sqladmin/layout.html" %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fa-solid fa-server"></i> 시스템 상태
                    </h3>
                </div>
                <div class="card-body">
                    <!-- Memory Usage -->
                    <h4>메모리 사용량</h4>
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="progress" style="height: 25px;">
                                <div class="progress-bar {{ 'bg-success' if memory.percent < 60 else ('bg-warning' if memory.percent < 80 else 'bg-danger') }}"
                                     role="progressbar"
                                     style="width: {{ memory.percent }}%;"
                                     aria-valuenow="{{ memory.percent }}"
                                     aria-valuemin="0"
                                     aria-valuemax="100">
                                    {{ memory.percent }}%
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <table class="table table-sm">
                                <tr>
                                    <td>전체</td>
                                    <td>{{ "%.2f"|format(memory.total / (1024**3)) }} GB</td>
                                </tr>
                                <tr>
                                    <td>사용중</td>
                                    <td>{{ "%.2f"|format(memory.used / (1024**3)) }} GB</td>
                                </tr>
                                <tr>
                                    <td>사용 가능</td>
                                    <td>{{ "%.2f"|format(memory.available / (1024**3)) }} GB</td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    <!-- CPU Usage -->
                    <h4>CPU 사용량</h4>
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="progress" style="height: 25px;">
                                <div class="progress-bar {{ 'bg-success' if cpu_percent < 60 else ('bg-warning' if cpu_percent < 80 else 'bg-danger') }}"
                                     role="progressbar"
                                     style="width: {{ cpu_percent }}%;"
                                     aria-valuenow="{{ cpu_percent }}"
                                     aria-valuemin="0"
                                     aria-valuemax="100">
                                    {{ cpu_percent }}%
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <table class="table table-sm">
                                <tr>
                                    <td>CPU 코어 수</td>
                                    <td>{{ cpu_count }}</td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    <!-- Disk Usage -->
                    <h4>디스크 사용량</h4>
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="progress" style="height: 25px;">
                                <div class="progress-bar {{ 'bg-success' if disk.percent < 60 else ('bg-warning' if disk.percent < 80 else 'bg-danger') }}"
                                     role="progressbar"
                                     style="width: {{ disk.percent }}%;"
                                     aria-valuenow="{{ disk.percent }}"
                                     aria-valuemin="0"
                                     aria-valuemax="100">
                                    {{ disk.percent }}%
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <table class="table table-sm">
                                <tr>
                                    <td>전체</td>
                                    <td>{{ "%.2f"|format(disk.total / (1024**3)) }} GB</td>
                                </tr>
                                <tr>
                                    <td>사용중</td>
                                    <td>{{ "%.2f"|format(disk.used / (1024**3)) }} GB</td>
                                </tr>
                                <tr>
                                    <td>사용 가능</td>
                                    <td>{{ "%.2f"|format(disk.free / (1024**3)) }} GB</td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    <!-- DB Connection Pool -->
                    <h4>데이터베이스 연결 풀</h4>
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>항목</th>
                                <th>값</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for key, value in db_pool.items() %}
                            <tr>
                                <td>{{ key }}</td>
                                <td>{{ value }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>

                    <!-- Process Info -->
                    <h4>프로세스 정보</h4>
                    <table class="table table-bordered">
                        <tbody>
                            <tr>
                                <td>PID</td>
                                <td>{{ process_info.pid }}</td>
                            </tr>
                            <tr>
                                <td>프로세스 메모리</td>
                                <td>{{ "%.2f"|format(process_info.memory_mb) }} MB</td>
                            </tr>
                            <tr>
                                <td>스레드 수</td>
                                <td>{{ process_info.num_threads }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
